## 问题定位

* 工具栏已重构为统一“插入表格”面板；除尺寸选择外其他按钮无响应。
* 原因：动作路由依赖矩形框选（rects）或“选择模式”开关；当前未框选时，动作没有目标落点，导致无效果。

## 修复方案

* 在 TableSelectionPlugin 中为所有动作提供“无框选时”的默认落点：使用当前光标所在单元格或当前表格。
* 统一事件路由：

  * mergeCells：若无选区则提示“请框选多个单元格”；有选区时按现逻辑合并。
  * splitCells：支持选区拆分；若无选区则拆分当前单元格（按 rowSpan/colSpan 恢复）。
  * alignVertical：选区批量设置垂直对齐；无选区则设置当前单元格。
  * alignHorizontal：按单元格样式设置 `text-align`（left/center/right）；无选区则设置当前单元格。
  * borderPreset/background：选区批量应用；无选区则应用当前单元格。
  * autoFitWindow/autoFitContent：优先作用于 hover 的表格；否则使用当前光标所在表格。
* 保持右键菜单与面板兼容，不改变其交互逻辑。

## 实施步骤

1. 在 TableSelectionPlugin 增加 `getCurrentCell()` 帮助函数，安全获取光标所在单元格。
2. 扩展 `applyAlign/applyHorizontal/applyBorder/applyBackground/doSplit/autoSize` 支持选区与单元格双模式。
3. 调整 `tableAction` 事件处理，默认落点优先级：选区 → 当前单元格 → 当前表格；并对合并无选区场景给出提示。
4. 保持批量更新的一次 `editor.update`，保证性能 <200ms。

## 测试

* 新增/更新用例：无选区时点击面板按钮应作用于当前单元格；合并需选区提示；自动调整应作用于当前表格。
* 运行：`npx vitest run --root . --environment jsdom tests/table-ui.spec.jsx`。

## 风险与兼容

* 不改变序列化结构（Lexical JSON）；样式仍写入 `TableCellNode.style` 与相关属性。
* 与右键菜单保持一致，不破坏现有功能。
