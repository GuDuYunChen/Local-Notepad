## 目标概述
- 将现有“固定3×3”的插入方式升级为可自定义尺寸与任意选择区域的交互。
- 实现矩形选择、多区域选择（Ctrl/Command）、整行/整列选择、删除/新增行列、清晰的高亮反馈。
- 增强快捷键模式的选中/退出机制与状态提示。

## 现状与入口
- 目前通过工具栏插入固定3×3表格：src/components/Editor/plugins/ToolbarPlugin.jsx:62-64。
- 使用 Lexical 官方 TableNode 体系：src/components/Editor/Editor.jsx:16-21, 94-98。

## 技术方案
### 1) 自定义表格尺寸选择器
- 在工具栏“插入表格”按钮附近新增下拉面板（Hover/Click），内部为网格预览（例如最大10×10），随鼠标移动显示选取范围与尺寸标签。
- 点击确定插入指定尺寸的表格；保留“直接插入默认3×3”的快速入口。
- 文件：ToolbarPlugin.jsx 新增组件 `TableSizePicker`（悬浮面板，独立状态与事件清理）。

### 2) 选择引擎（TableSelectionPlugin）
- 新增插件负责表格选择与高亮渲染：`TableSelectionPlugin.jsx`。
- 功能：
  - 矩形选择：按下鼠标于单元格 A，拖动到单元格 B，通过坐标计算（row, col）得到矩形区域；在 `editor.update` 中写入临时选择状态（不改节点数据）。
  - 多区域选择：按住 Ctrl/Command 时，矩形选择结果叠加到集合（去重）。
  - 整行/整列选择：行头/列头点击触发，将整行/列加入集合。
  - 视觉反馈：通过“装饰层”渲染覆盖层（绝对定位 DIV），或给被选单元格附加临时 CSS 类（不改变JSON结构）。
  - 事件清理：在 `useEffect` 里注册/移除 `mousedown/mousemove/mouseup` 与 `keydown/keyup`。
- 数据结构：
  - Plugin 内部维护 `selectedRanges: Array<{r1,c1,r2,c2}>` 与 `selectedRows`, `selectedCols`。
  - 通过 `mergeRegister` 注册编辑器命令（如 `TABLE_SELECTION_SET`, `TABLE_SELECTION_CLEAR`），供其他组件调用。

### 3) 行列操作命令
- 新增一组命令：`TABLE_ADD_ROW`, `TABLE_DELETE_ROW`, `TABLE_ADD_COL`, `TABLE_DELETE_COL`。
- 实现：
  - 在 `editor.update` 遍历命令目标表格节点，通过 Table API 创建/删除对应行/列；更新后保持光标与滚动位置。
  - 操作作用域：若有选区，针对选区的最小矩形边界进行行/列的批量修改；若无选区，使用当前光标所在单元格。
- 入口：Toolbar 中显示“插入行/列”、“删除行/列”按钮；也在右键菜单暴露。

### 4) 快捷键模式（选中状态记忆与切换）
- 模式定义：`SelectionMode`（激活后快捷键与鼠标以“表格选择优先”）；
- 行为：
  - 首次按键（例如 `Ctrl+Shift+T` 或工具栏“选择模式”）：开启模式，显示醒目视觉（工具栏按钮高亮、状态提示文案）。
  - 再次按键：清除所有选中（发送 `TABLE_SELECTION_CLEAR`）、退出模式。
- 状态提示：在编辑器状态栏右侧增加“选择模式：开/关”；文件：src/components/TextEditor.jsx:141-144 的状态栏处扩展一行文案与图标。

### 5) 高亮与边界视觉
- CSS：新增 `.table-selection-cell`, `.table-selection-border`，高亮选中单元格并在矩形外缘绘制边框；整行/整列采用浅色背景整片覆盖。
- 采用“不会影响内容序列化”的方式：选择信息只在 UI 层，不写入文档 JSON。

### 6) 响应式与性能
- 在小屏下选择器面板宽度与网格尺寸自适应（最多 6×6 可视预览，滚动列表显示更多尺寸）。
- 选择引擎使用节流处理 `mousemove`，只在坐标变化时重绘，避免卡顿。

### 7) 键鼠映射与可访问性
- 键盘：方向键 + Shift 扩展矩形选区；Ctrl/Command 叠加多个选区。
- 右键菜单：在表格区域显示“整行/整列选择”“添加/删除行列”等。
- ARIA：为选择器面板与状态提示增加 `role` 与提示文本。

## 代码变更点
- 新增：`src/components/Editor/plugins/TableSelectionPlugin.jsx`
- 修改：
  - `src/components/Editor/plugins/ToolbarPlugin.jsx`（插入尺寸选择器、行列操作按钮、选择模式开关）
  - `src/components/Editor/Editor.css`（表格选择高亮与边界样式）
  - `src/components/TextEditor.jsx`（状态栏增加选择模式提示）

## 测试计划
- 单元：
  - 选择范围计算函数（行列坐标 → 矩形/多选集合），边界与重叠合并。
- 交互：
  - 鼠标拖拽与 Ctrl 多选在不同表格尺寸下的准确性。
  - 整行/整列选择后执行删除与新增的正确性。
- 兼容：
  - 非表格内容编辑不受影响；模式关闭时恢复默认行为。

## 风险与规避
- 与 Lexical Table 原生选择的兼容：自定义选择只作为可视化与操作层，不破坏原生节点结构。
- 大表格性能：对 `mousemove` 进行节流 + 只更新变化区域。

## 交付
- 注释与组件化遵循规范，事件监听在 `useEffect` 中注册并清理。
- 追加简短文档说明：表格选择与操作的使用方式、快捷键清单；集成到 README 对应章节。